local function a(b,c,d)local e="?"for f,g in pairs(d)do e=e..textutils.urlEncode(f).."="..textutils.urlEncode(g).."&"end;e=e:sub(1,#e-1)local h=http.get(b..c..e)if not h then return{success=false}end;local i=textutils.unserialize(h.readAll())h.close()if not i then return{success=false}end;return i end;local j={__index={lookup=function(k)if type(k)~="table"then error("Expected table",2)end;local i=a(k.server,"api",{get="socket",name=k.name,id=k.id})return i.success,i.data end,ping=function(k)if type(k)~="table"then error("Expected table",2)end;local i=a(k.server,"api/ping",{name=k.name,id=k.id})return i.success end,send=function(k,l,m)if type(k)~="table"or type(l)~="string"or type(m)~="string"then error("Expected table, string, string",2)end;local i=a(k.server,"api/send",{name=k.name,id=k.id,to=l,message=m})return i.success,i.data end,receive=function(k)if type(k)~="table"then error("Expected table",2)end;local i=a(k.server,"api/receive",{name=k.name,id=k.id})return i.success,i.data end,close=function(k)if type(k)~="table"then error("Expected table",2)end;local i=a(k.server,"api/disconnect",{name=k.name,id=k.id})return i.success end}}function connect(b,n)local o,p=http.checkURL(b)local i;if not o then error(p,2)end;i=a(b,"api",{})if not i.success then return false end;i=a(b,"api/connect",{name=n})if not i.success then return false end;local k={server=b,name=i.data.name,id=i.data.id}setmetatable(k,j)return k end;function time(b)if type(b)~="string"then error("Expected string",2)end;local i=a(b,"api",{get="time"})return i.success,i.data end;function lookup(b,n)if type(b)~="string"then error("Expected string",2)elseif n and type(n)~="string"then error("Expected string, string",2)end;local i=a(b,"api",{get="socket",name=n})return i.success,i.data end
