<!DOCTYPE html>
<html>
  <head>
    <title>ClassiCube Terrain Tool</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="icon" href="../favicon.ico">
  </head>
  <body>
    <noscript>Javascript is required</noscript>
    <img id="output" src="">
    <script>
        var canvas = document.createElement("canvas");
        var context = canvas.getContext("2d");
        var outputimg = document.getElementById("output");
        
        var varibles = get();
        
        canvas.width = canvas.height = 1024;
        context.imageSmoothingEnabled = false;
        
        context.clearRect(0, 0, 1024, 1024);
        
        if (varibles["src"]) {
          var img = new Image();
          img.crossOrigin = "anonymous";
          
          var nimg = new Image();
          nimg.crossOrigin = "anonymous";
          
          img.src = varibles["src"];
          
          img.addEventListener("load", function() {
            context.save();
            context.scale(1024/img.width,1024/img.height);
            context.drawImage(img, 0, 0);
            context.restore();
            
            nimg.src = "numbers.png";
            
            nimg.addEventListener("load", function() {
              context.drawImage(nimg, 0, 0);
              
              outputimg.src = canvas.toDataUrl();
            });
          });
        }
        
        function get() {
          var varibles = window.location.search.substring(1).split("&");
          var got = {};
          for (var i = 0; i < varibles.length; i++) {
            var varible = varibles[i].split("=");
            got[varible[0]] = varible[1];
          }
          return got;
        }
    </script>
  </body>
</html>
